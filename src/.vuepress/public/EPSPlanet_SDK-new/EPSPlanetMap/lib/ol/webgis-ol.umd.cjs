(function(o,p){typeof exports=="object"&&typeof module<"u"?p(exports,require("ol"),require("ol/proj/Projection"),require("ol/proj"),require("ol/layer"),require("ol/source"),require("ol/format"),require("ol/style.js"),require("ol/control/defaults"),require("ol/style/Style"),require("ol/style/Text"),require("ol/tilegrid/TileGrid"),require("ol/tilegrid/WMTS"),require("ol/extent"),require("ol/control/Zoom"),require("ol-ext/control/LayerShop"),require("ol-ext/control/LayerSwitcher"),require("ol/events"),require("ol-ext/control/EditBar"),require("ol-ext/control/Toggle"),require("ol-ext/control/Notification"),require("ol/layer/Vector"),require("ol/source/Vector"),require("ol/sphere"),require("ol/style/Circle"),require("ol/style/Stroke"),require("ol/style/Fill"),require("ol/format/EsriJSON"),require("ol/format/GeoJSON"),require("ol/interaction/Select"),require("ol/interaction/Modify"),require("ol-ext/control/Button"),require("ol/interaction/DoubleClickZoom"),require("ol/proj/proj4"),require("proj4"),require("uuid"),require("ol-ext/control/Overview"),require("ol-ext/control/Swipe"),require("ol/Observable"),require("ol/Feature"),require("ol/geom/Point"),require("ol/easing"),require("ol-ext/featureAnimation/Show"),require("ol/control")):typeof define=="function"&&define.amd?define(["exports","ol","ol/proj/Projection","ol/proj","ol/layer","ol/source","ol/format","ol/style.js","ol/control/defaults","ol/style/Style","ol/style/Text","ol/tilegrid/TileGrid","ol/tilegrid/WMTS","ol/extent","ol/control/Zoom","ol-ext/control/LayerShop","ol-ext/control/LayerSwitcher","ol/events","ol-ext/control/EditBar","ol-ext/control/Toggle","ol-ext/control/Notification","ol/layer/Vector","ol/source/Vector","ol/sphere","ol/style/Circle","ol/style/Stroke","ol/style/Fill","ol/format/EsriJSON","ol/format/GeoJSON","ol/interaction/Select","ol/interaction/Modify","ol-ext/control/Button","ol/interaction/DoubleClickZoom","ol/proj/proj4","proj4","uuid","ol-ext/control/Overview","ol-ext/control/Swipe","ol/Observable","ol/Feature","ol/geom/Point","ol/easing","ol-ext/featureAnimation/Show","ol/control"],p):(o=typeof globalThis<"u"?globalThis:o||self,p(o["webgis-ol"]={},o.ol,o.ol.proj.Projection,o.ol.proj,o.ol.layer,o.ol.source,o.ol.format,o.ol.style,o.ol.control.defaults,o.ol.style.Style,o.ol.style.Text,o.ol.tilegrid.TileGrid,o.ol.tilegrid.WMTS,o.ol.extent,o.ol.control.Zoom,o.ol.control.LayerShop,o.ol.control.LayerSwitcher,o.ol.events,o.ol.control.EditBar,o.ol.control.Toggle,o.ol.control.Notification,o.ol.layer.Vector,o.ol.source.Vector,o.ol.sphere,o.ol.style.Circle,o.ol.style.Stroke,o.ol.style.Fill,o.ol.format.EsriJSON,o.ol.format.GeoJSON,o.ol.interaction.Select,o.ol.interaction.Modify,o.ol.control.Button,o.ol.interaction.DoubleClickZoom,o.ol.proj.proj4,o.proj4,o.uuid,o.ol.control.Overview,o.ol.control.Swipe,o.ol.Observable,o.ol.Feature,o.ol.geom.Point,o.ol.easing,o.ol.featureAnimation.Show,o.ol.control))})(this,function(o,p,b,C,nt,yr,br,Mr,$r,ot,Sr,$t,Cr,lt,Pr,Lr,Or,jr,Tr,Er,St,Ct,Pt,_r,Lt,ct,Ot,Ir,jt,Dr,Ar,qr,xr,Fr,Tt,Nr,Gr,Br,Wr,Vr,Rr,Et,Hr,zr){var be,R,Me,gt,Q,H,He,or,ze,lr,ee,Ue,cr,I,D,Ze,hr,te,st,ie,se,ae,ne,$e,oe,le,Se,z,Je,Ce,vt,ke,ur,Xe,dr,ce,at,he,Ke,mr,Pe,wt,Ye,pr,Le,yt,Qe,fr,et,gr,U,B,ge,Z,tr,T,ue,W,V,de,Oe,tt,me,je,bt,rt,vr,J,_e,Te,Mt,it,wr,rr,k,X,x,pe,ir,K,fe,Ee,sr;"use strict";var Ki=Object.defineProperty;var Yi=(o,p,b)=>p in o?Ki(o,p,{enumerable:!0,configurable:!0,writable:!0,value:b}):o[p]=b;var ar=(o,p,b)=>(Yi(o,typeof p!="symbol"?p+"":p,b),b),ft=(o,p,b)=>{if(!p.has(o))throw TypeError("Cannot "+b)};var c=(o,p,b)=>(ft(o,p,"read from private field"),b?b.call(o):p.get(o)),h=(o,p,b)=>{if(p.has(o))throw TypeError("Cannot add the same private member more than once");p instanceof WeakSet?p.add(o):p.set(o,b)},m=(o,p,b,C)=>(ft(o,p,"write to private field"),C?C.call(o,b):p.set(o,b),b),nr=(o,p,b,C)=>({set _(nt){m(o,p,nt,b)},get _(){return c(o,p,C)}}),d=(o,p,b)=>(ft(o,p,"access private method"),b);function Ie(s){const i=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(s){for(const e in s)if(e!=="default"){const t=Object.getOwnPropertyDescriptor(s,e);Object.defineProperty(i,e,t.get?t:{enumerable:!0,get:()=>s[e]})}}return i.default=s,Object.freeze(i)}const O=Ie(nt),v=Ie(yr),$=Ie(br),N=Ie(Mr);class _t{constructor(i){const e=Object.assign({},i),t=new ot(e);return r=>{const a=t.getText();return a.setFeature&&a.setFeature(r),t}}}class It extends Sr{constructor(e){super(e);h(this,Me);h(this,be,void 0);h(this,R,void 0);m(this,R,e.text)}setFeature(e){m(this,be,e)}getText(){try{let e;return Array.isArray(c(this,R))?e=c(this,R).map(t=>d(this,Me,gt).call(this,t)):e=d(this,Me,gt).call(this,c(this,R)),e}catch(e){console.error(e);return}}}be=new WeakMap,R=new WeakMap,Me=new WeakSet,gt=function(e){return e.replace(/\{(.+?)\}/g,(...t)=>{var r;return(r=c(this,be))==null?void 0:r.get(t[1])})};var g={},ht={},ut={},ve={};ve.forEachPoint=function(s){return function(i,e,t){var r=i.length,a=t||2,n;e?n=e:a!==2?n=i.slice():n=new Array(r);for(var l=0;l<r;l+=a)s(i,n,l);return n}};var Dt=ve.forEachPoint,At=[1289059486e-2,836237787e-2,5591021,348198983e-2,167804312e-2,0],De=[75,60,45,30,15,0],Ur=[[1410526172116255e-23,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,173379812e-1],[-7435856389565537e-24,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,1026014486e-2],[-3030883460898826e-23,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,685681737e-2],[-1981981304930552e-23,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,448277706e-2],[309191371068437e-23,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,25551644e-1],[2890871144776878e-24,8983055095805407e-21,-3068298e-14,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],qt=[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,6477955746671607e-7,-4082003173641316e-6,1077490566351142e-5,-1517187553151559e-5,1205306533862167e-5,-5124939663577472e-6,9133119359512032e-7,67.5],[.00337398766765,111320.7020202162,4481351045890365e-9,-2339375119931662e-8,7968221547186455e-8,-1159649932797253e-7,9723671115602145e-8,-4366194633752821e-8,8477230501135234e-9,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837749470245e-9,992013.7397791013,-122195221711287e-8,1340652697009075e-9,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758690035394e-9,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]];function Zr(s,i,e){return s=Math.max(s,i),s=Math.min(s,e),s}function Jr(s,i,e){for(var t=e-i;s>e;)s-=t;for(;s<i;)s+=t;return s}function xt(s,i,e,t){var r=s[e],a=s[e+1],n=t[0]+t[1]*Math.abs(r),l=Math.abs(a)/t[9],u=t[2]+t[3]*l+t[4]*l*l+t[5]*l*l*l+t[6]*l*l*l*l+t[7]*l*l*l*l*l+t[8]*l*l*l*l*l*l;i[e]=n*(r<0?-1:1),i[e+1]=u*(a<0?-1:1)}ut.forward=Dt(function(s,i,e){var t=Jr(s[e],-180,180),r=Zr(s[e+1],-74,74),a=null,n;for(n=0;n<De.length;++n)if(r>=De[n]){a=qt[n];break}if(a===null){for(n=De.length-1;n>=0;--n)if(r<=-De[n]){a=qt[n];break}}i[e]=t,i[e+1]=r,xt(i,i,e,a)}),ut.inverse=Dt(function(s,i,e){for(var t=Math.abs(s[e+1]),r=null,a=0;a<At.length;a++)if(t>=At[a]){r=Ur[a];break}xt(s,i,e,r)});var dt={},Ft=ve.forEachPoint,Ae=6378137,Nt=85.0511287798,qe=Math.PI/180;dt.forward=Ft(function(s,i,e){var t=Math.max(Math.min(Nt,s[e+1]),-Nt),r=Math.sin(t*qe);i[e]=Ae*s[e]*qe,i[e+1]=Ae*Math.log((1+r)/(1-r))/2}),dt.inverse=Ft(function(s,i,e){i[e]=s[e]/Ae/qe,i[e+1]=(2*Math.atan(Math.exp(s[e+1]/Ae))-Math.PI/2)/qe}),ht.baiduMercator=ut,ht.sphericalMercator=dt;var mt={},we={},xe={},Gt=ve.forEachPoint,P=Math.PI,Bt=6378245,Wt=.006693421622965943;function Vt(s,i){var e=kr(s-105,i-35),t=Xr(s-105,i-35),r=i/180*P,a=Math.sin(r);a=1-Wt*a*a;var n=Math.sqrt(a);return e=e*180/(Bt*(1-Wt)/(a*n)*P),t=t*180/(Bt/n*Math.cos(r)*P),[t,e]}function Rt(s,i){return s<72.004||s>137.8347||i<.8293||i>55.8271}function kr(s,i){var e=-100+2*s+3*i+.2*i*i+.1*s*i+.2*Math.sqrt(Math.abs(s));return e+=(20*Math.sin(6*s*P)+20*Math.sin(2*s*P))*2/3,e+=(20*Math.sin(i*P)+40*Math.sin(i/3*P))*2/3,e+=(160*Math.sin(i/12*P)+320*Math.sin(i*P/30))*2/3,e}function Xr(s,i){var e=300+s+2*i+.1*s*s+.1*s*i+.1*Math.sqrt(Math.abs(s));return e+=(20*Math.sin(6*s*P)+20*Math.sin(2*s*P))*2/3,e+=(20*Math.sin(s*P)+40*Math.sin(s/3*P))*2/3,e+=(150*Math.sin(s/12*P)+300*Math.sin(s/30*P))*2/3,e}xe.toWGS84=Gt(function(s,i,e){var t=s[e],r=s[e+1];if(!Rt(t,r)){var a=Vt(t,r);t=t-a[0],r=r-a[1]}i[e]=t,i[e+1]=r}),xe.fromWGS84=Gt(function(s,i,e){var t=s[e],r=s[e+1];if(!Rt(t,r)){var a=Vt(t,r);t=t+a[0],r=r+a[1]}i[e]=t,i[e+1]=r});var Ht=ve.forEachPoint,zt=xe,Kr=Math.PI,Fe=Kr*3e3/180,Yr=we.toGCJ02=Ht(function(s,i,e){var t=s[e]-.0065,r=s[e+1]-.006,a=Math.sqrt(t*t+r*r)-2e-5*Math.sin(r*Fe),n=Math.atan2(r,t)-3e-6*Math.cos(t*Fe);return i[e]=a*Math.cos(n),i[e+1]=a*Math.sin(n),i}),Qr=we.fromGCJ02=Ht(function(s,i,e){var t=s[e],r=s[e+1],a=Math.sqrt(t*t+r*r)+2e-5*Math.sin(r*Fe),n=Math.atan2(r,t)+3e-6*Math.cos(t*Fe);return i[e]=a*Math.cos(n)+.0065,i[e+1]=a*Math.sin(n)+.006,i});we.toWGS84=function(s,i,e){var t=Yr(s,i,e);return zt.toWGS84(t,t,e)},we.fromWGS84=function(s,i,e){var t=zt.fromWGS84(s,i,e);return Qr(t,t,e)},mt.bd09=we,mt.gcj02=xe;var q=ht,ye=mt;g.smerc2bmerc=function(s,i,e){var t=q.sphericalMercator.inverse(s,i,e);return t=ye.bd09.fromWGS84(t,t,e),q.baiduMercator.forward(t,t,e)},g.bmerc2smerc=function(s,i,e){var t=q.baiduMercator.inverse(s,i,e);return t=ye.bd09.toWGS84(t,t,e),q.sphericalMercator.forward(t,t,e)},g.bmerc2ll=function(s,i,e){var t=q.baiduMercator.inverse(s,i,e);return ye.bd09.toWGS84(t,t,e)},g.ll2bmerc=function(s,i,e){var t=ye.bd09.fromWGS84(s,i,e);return q.baiduMercator.forward(t,t,e)},g.ll2smerc=q.sphericalMercator.forward,g.smerc2ll=q.sphericalMercator.inverse,g.datum=ye,g.projection=q;const Ne=new C.Projection({code:"BD:09",extent:[-2003772637e-2,-1170804166e-2,2003772637e-2,1247410417e-2],units:"m",axisOrientation:"neu",global:!1});C.addProjection(Ne),C.addCoordinateTransforms("EPSG:4326",Ne,g.ll2bmerc,g.bmerc2ll),C.addCoordinateTransforms("EPSG:3857",Ne,g.smerc2bmerc,g.bmerc2smerc);var Ge=function(s){return function(i,e,t){var r=i.length,a=t||2,n;e?n=e:a!==2?n=i.slice():n=new Array(r);for(var l=0;l<r;l+=a)s(i,n,l);return n}},Y={},L=Math.PI,Ut=6378245,Zt=.006693421622965943;function Jt(s,i){var e=ei(s-105,i-35),t=ti(s-105,i-35),r=i/180*L,a=Math.sin(r);a=1-Zt*a*a;var n=Math.sqrt(a);return e=e*180/(Ut*(1-Zt)/(a*n)*L),t=t*180/(Ut/n*Math.cos(r)*L),[t,e]}function kt(s,i){return s<72.004||s>137.8347||i<.8293||i>55.8271}function ei(s,i){var e=-100+2*s+3*i+.2*i*i+.1*s*i+.2*Math.sqrt(Math.abs(s));return e+=(20*Math.sin(6*s*L)+20*Math.sin(2*s*L))*2/3,e+=(20*Math.sin(i*L)+40*Math.sin(i/3*L))*2/3,e+=(160*Math.sin(i/12*L)+320*Math.sin(i*L/30))*2/3,e}function ti(s,i){var e=300+s+2*i+.1*s*s+.1*s*i+.1*Math.sqrt(Math.abs(s));return e+=(20*Math.sin(6*s*L)+20*Math.sin(2*s*L))*2/3,e+=(20*Math.sin(s*L)+40*Math.sin(s/3*L))*2/3,e+=(150*Math.sin(s/12*L)+300*Math.sin(s/30*L))*2/3,e}Y.toWGS84=Ge(function(s,i,e){var t=s[e],r=s[e+1];if(!kt(t,r)){var a=Jt(t,r);t=t-a[0],r=r-a[1]}i[e]=t,i[e+1]=r}),Y.fromWGS84=Ge(function(s,i,e){var t=s[e],r=s[e+1];if(!kt(t,r)){var a=Jt(t,r);t=t+a[0],r=r+a[1]}i[e]=t,i[e+1]=r});var Be={},We=6378137,Xt=85.0511287798,Ve=Math.PI/180;Be.forward=Ge(function(s,i,e){var t=Math.max(Math.min(Xt,s[e+1]),-Xt),r=Math.sin(t*Ve);i[e]=We*s[e]*Ve,i[e+1]=We*Math.log((1+r)/(1-r))/2}),Be.inverse=Ge(function(s,i,e){i[e]=s[e]/We/Ve,i[e+1]=(2*Math.atan(Math.exp(s[e+1]/We))-Math.PI/2)/Ve}),g.ll2gmerc=function(s,i,e){let t=Y.fromWGS84(s,i,e);return g.ll2smerc(t,t,e)},g.gmerc2ll=function(s,i,e){let t=g.smerc2ll(s,s,e);return Y.toWGS84(t,i,e)},g.smerc2gmerc=function(s,i,e){let t=g.smerc2ll(s,s,e);return t=Y.fromWGS84(t,t,e),g.ll2smerc(t,t,e)},g.gmerc2smerc=function(s,i,e){let t=g.smerc2ll(s,s,e);return t=Y.toWGS84(t,t,e),g.ll2smerc(t,t,e)},g.ll2smerc=Be.forward,g.smerc2ll=Be.inverse;const ri=[-20037508342789244e-9,-20037508342789244e-9,20037508342789244e-9,20037508342789244e-9],pt=new C.Projection({code:"GCJ-02",extent:ri,units:"m"});C.addProjection(pt),C.addCoordinateTransforms("EPSG:4326",pt,g.ll2gmerc,g.gmerc2ll),C.addCoordinateTransforms("EPSG:3857",pt,g.smerc2gmerc,g.gmerc2smerc);const Kt={map:p.Map,view:p.View,projection:b,defaults:$r.defaults,graticule:O.Graticule,group:O.Group,heatmap:O.Heatmap,image:O.Image,layer:O.Layer,mapboxvector:O.MapboxVector,tile:O.Tile,vector:O.Vector,vectorimage:O.VectorImage,vectortile:O.VectorTile,webglpoints:O.WebGLPoints,webgltile:O.WebGLTile,"bingmaps-source":v.BingMaps,"cartodb-source":v.CartoDB,"cluster-source":v.Cluster,"datatile-source":v.DataTile,"geotiff-source":v.GeoTIFF,"iiif-source":v.IIIF,"imagearcgisrest-source":v.ImageArcGISRest,"imagecanvas-source":v.ImageCanvas,"imagemapguide-source":v.ImageMapGuide,"imagestatic-source":v.ImageStatic,"imagewms-source":v.ImageWMS,"osm-source":v.OSM,"raster-source":v.Raster,"stamen-source":v.Stamen,"tilearcgisrest-source":v.TileArcGISRest,"tiledebug-source":v.TileDebug,"tileimage-source":v.TileImage,"tilejson-source":v.TileJSON,"tilewms-source":v.TileWMS,"urltile-source":v.UrlTile,"utfgrid-source":v.UTFGrid,"vector-source":v.Vector,"vectortile-source":v.VectorTile,"wmts-source":v.WMTS,tilegrid:$t,"wmts-tilegrid":Cr,"xyz-source":v.XYZ,"zoomify-source":v.Zoomify,esrijson:$.EsriJSON,geojson:$.GeoJSON,gml:$.GML,gpx:$.GPX,igc:$.IGC,iiifinfo:$.IIIFInfo,kml:$.KML,mvt:$.MVT,ows:$.OWS,polyline:$.Polyline,topojson:$.TopoJSON,wfs:$.WFS,wkb:$.WKB,wkt:$.WKT,wmscapabilities:$.WMSCapabilities,wmsgetfeatureinfo:$.WMSGetFeatureInfo,wmtscapabilities:$.WMTSCapabilities,circle:N.Circle,fill:N.Fill,icon:N.Icon,iconimage:N.IconImage,regularshape:N.RegularShape,stroke:N.Stroke,style:N.Style,text:N.Text,"style-fn":_t,"text-fn":It},G=(s,i)=>{var t;if(s===null||typeof s!="object"||i=="params"||i=="props")return s;s.type=="wmts-source"&&(s.projection=s.projection??"EPSG:3857",s.tileGrid.projection=s.projection,s.tileGrid.matrixSet=s.matrixSet);const e=JSON.parse(JSON.stringify(s));try{if(Array.isArray(e)){for(let a=0;a<e.length;a++)e[a]=G(e[a]);return e}Object.keys(e).forEach(a=>{e[a]=G(e[a],a)}),i=="source"&&(e.crossOrigin="anonymous"),i=e.type||i;const r=Yt(i);if(!r)throw new Error(`Cannot find a constructor of type ${i}`);if(s.type=="wmts-tilegrid"){let a=ii(e);e.origin=a.origin,e.resolutions||(e.resolutions=a.resolutions),e.matrixIds=a.matrixIds}return((t=s.sourceType)==null?void 0:t.indexOf("百度"))>-1&&(e.source=si(e.sourceType)),new r(e)}catch(r){return console.error(r),e}};window.getObject=G;const Yt=s=>{if(s)return Kt[s.toLowerCase()]},ii=s=>{const i=s.projection??"EPSG:3857",e=s.maxZoom??18,t=s.minZoom??0,r=s.tileSize??256,a=s.matrixSet??"EPSG:3857",l=C.get(i).getExtent(),u=lt.getTopLeft(l),f=[],w=lt.getWidth(l)/r,M=e-t+1,A=new Array(M),y=new Array(M);for(let S=t;S<=e;S++)a.indexOf("EPSG")>-1?y[S-t]=i+":"+S:y[S-t]=S,s.tileTool=="geoserver"?A[S-t]=w/Math.pow(2,S+1):A[S-t]=w/Math.pow(2,S),f.push(u);return{origin:u,origins:f,matrixIds:y,resolutions:A}},si=s=>{for(var i=[],e=0;e<19;e++)i[e]=Math.pow(2,18-e);var t=new $t({origin:[0,0],resolutions:i});return new v.TileImage({crossOrigin:"Anonymous",projection:Ne,tileGrid:t,tileUrlFunction:function(a){if(!a)return"";var n=a[0],l=a[1],u=-a[2]-1;return l<0&&(l="M"+-l),u<0&&(u="M"+-u),s=="百度矢量底图"?"http://online3.map.bdimg.com/tile/?qt=tile&x="+l+"&y="+u+"&z="+n+"&styles=pl&udt=20170809&scaler=1&p=1":s=="百度影像底图"?"http://shangetu"+Math.round(Math.random()*3)+".map.bdimg.com/it/u=x="+l+";y="+u+";z="+n+";v=009;type=sate&fm=46&udt=20170919":s=="百度影像注记"?"http://online3.map.bdimg.com/onlinelabel/?qt=tile&x="+l+"&y="+u+"&z="+n+"&styles=sl&udt=20170919&scaler=1&p=1":s=="百度矢量注记"?"http://online3.map.bdimg.com/onlinelabel/?qt=tile&x="+l+"&y="+u+"&z="+n+"&styles=pl&udt=20170919&scaler=1&p=1":"http://online3.map.bdimg.com/tile/?qt=tile&x="+l+"&y="+u+"&z="+n+"&styles=pl&udt=20170809&scaler=1&p=1"}})};var E=(s=>(s[s.none=0]="none",s[s.funOnly=1]="funOnly",s[s.propOnly=2]="propOnly",s[s.always=3]="always",s))(E||{});const j=s=>i=>(i.prototype._manifest=ai(s),customElements.define(s.tagName,i),i),ai=s=>(s=Object.assign({hasConfig:!1,mode:E.always},s),s),Qt=s=>{Promise?Promise.resolve().then(s):requestAnimationFrame?requestAnimationFrame(s):setTimeout(s,0)},Qi="",ni=`<div class="error">\r
    <div class="info">\r
        <div>\r
            <p>软件未授权，请联系软件提供商，获取授权码！</p>\r
            <a href="">刷新</a>\r
        </div>\r
    </div>\r
</div>`,oi=`<div class="develop">\r
    开发预览版，有限期至【】@山维科技\r
</div>`,re=class{constructor(){h(this,He);h(this,ze);h(this,Ue);h(this,Ze);h(this,te);h(this,H,"开发版");h(this,ee,null);h(this,I,null);h(this,D,null);if(new.target===re)return c(re,Q)||m(re,Q,this),c(re,Q)}get authtype(){return c(this,H)}get authorized(){return d(this,ze,lr).call(this)}};let Re=re;Q=new WeakMap,H=new WeakMap,He=new WeakSet,or=function(i,e){try{if(!i||i.length<8)return"";e||(e="sunway_webgis_auth_code"),e=encodeURIComponent(e);let t="";for(let M=0;M<e.length;M+=1)t+=e.charCodeAt(M).toString();let r=Math.floor(t.length/5),a=parseInt(t.charAt(r)+t.charAt(r*2)+t.charAt(r*3)+t.charAt(r*4)+t.charAt(r*5)),n=Math.round(e.length/2),l=Math.pow(2,31)-1,u=parseInt(i.substring(i.length-8,i.length),16);for(i=i.substring(0,i.length-8),t+=u;t.length>10;)t=(parseInt(t.substring(0,10))+parseInt(t.substring(10,t.length))).toString();t=(a*t+n)%l;let f="",w="";for(let M=0;M<i.length;M+=2)f=parseInt(i.substring(M,M+2),16)^Math.floor(t/l*255),w+=String.fromCharCode(f),t=(a*t+n)%l;return decodeURIComponent(w)}catch{return""}},ze=new WeakSet,lr=function(){const i=d(this,He,or).call(this,window.licenses),e=i.split("|")[0],t=i.split("|")[1];m(this,H,i.split("|")[2]);let r=window.location.hostname.toUpperCase();if(r==="LOCALHOST"||r=="127.0.0.1")return!0;let a=!1;if(e.split(",").forEach(f=>{if(f.toUpperCase()===r){a=!0;return}}),!a)return d(this,te,st).call(this,"软件未授权，请联系软件提供商，获取授权码！"),!1;if(typeof t>"u")return d(this,te,st).call(this,"软件未授权，请联系软件提供商，获取授权码！"),!1;const l=d(this,Ue,cr).call(this),u=new Date(t);return l.getTime()>u.getTime()?(d(this,te,st).call(this,c(this,H)+"有限期至【"+t+"】已过期，请重新授权！@山维科技"),!1):(c(this,H)!="正式版"&&d(this,Ze,hr).call(this,"开发预览版，有限期至【"+t+"】@山维科技"),!0)},ee=new WeakMap,Ue=new WeakSet,cr=function(){if(!c(this,ee)){const i=new window.XMLHttpRequest;i.open("GET","/",!1),i.send(null);const e=i.getResponseHeader("Date");m(this,ee,new Date(e))}return c(this,ee)},I=new WeakMap,D=new WeakMap,Ze=new WeakSet,hr=function(i){c(this,D)||(m(this,D,document.createElement("div")),c(this,D).style.zIndex="999",c(this,D).classList.add("auth"),c(this,D).innerHTML=oi,document.body.appendChild(c(this,D)));const e=c(this,D).getElementsByClassName("develop")[0];e.innerHTML=i},te=new WeakSet,st=function(i){c(this,I)||(m(this,I,document.createElement("div")),c(this,I).style.zIndex="1000",c(this,I).classList.add("auth"),c(this,I).innerHTML=ni,document.body.appendChild(c(this,I)));const e=c(this,I).getElementsByTagName("p")[0];e.innerHTML=i},h(Re,Q,void 0);class _ extends HTMLElement{constructor(){super();h(this,Ce);h(this,ke);h(this,Xe);h(this,ce);h(this,Ke);h(this,Pe);h(this,Ye);h(this,Le);h(this,Qe);h(this,et);h(this,B);h(this,ie,void 0);h(this,se,void 0);h(this,ae,void 0);h(this,ne,void 0);h(this,$e,void 0);h(this,oe,void 0);h(this,le,"w-l");h(this,Se,!1);h(this,z,E.none);h(this,Je,["value","src","title"]);h(this,he,!1);h(this,U,"unInited");new Re().authorized&&(this.manifest.hasConfig&&d(this,Ce,vt).call(this,this.getAttribute("config")||this.getAttribute("configUrl")),m(this,z,this.manifest.mode??E.always),Qt(()=>{d(this,Xe,dr).call(this),d(this,B,ge).call(this)}))}startup(e){this.mapView=e.mapView,this.map=e.map,this.mapConfig=e.mapConfig,this.config=e.config}get manifest(){return this._manifest}get mapConfig(){return c(this,ie)}set mapConfig(e){!c(this,ie)&&e&&(m(this,ie,e),d(this,B,ge).call(this))}get mapView(){return c(this,se)}set mapView(e){!c(this,se)&&e&&(m(this,se,e),d(this,B,ge).call(this))}get map(){return c(this,ae)}set map(e){!c(this,ae)&&e&&(m(this,ae,e),d(this,B,ge).call(this))}get config(){return c(this,ne)}set config(e){if(typeof e=="string"){d(this,Ce,vt).call(this,e);return}else typeof e=="object"&&!c(this,ne)&&e&&(m(this,ne,e),d(this,B,ge).call(this))}get loading(){return!!c(this,$e)}set loading(e){m(this,$e,e),d(this,ke,ur).call(this)}get $data(){return c(this,oe)}set $data(e){(c(this,z)&E.propOnly)==E.propOnly?(m(this,oe,d(this,ce,at).call(this,e)),d(this,Pe,wt).call(this)):m(this,oe,e)}isReady(){return!!(this.map&&this.mapView&&this.mapConfig&&(this.config||!this.manifest.hasConfig))}async onInit(){}afterInit(){}onOpen(){}onClose(){}}ie=new WeakMap,se=new WeakMap,ae=new WeakMap,ne=new WeakMap,$e=new WeakMap,oe=new WeakMap,le=new WeakMap,Se=new WeakMap,z=new WeakMap,Je=new WeakMap,Ce=new WeakSet,vt=async function(e){if(!this.config&&e){this.loading=!0;const t=await fetch(e);this.config=t&&t.ok&&await t.json()||{},this.loading=!1}},ke=new WeakSet,ur=function(){this.loading?this.classList.add("loading"):this.classList.remove("loading")},Xe=new WeakSet,dr=function(){const e=this.manifest.className||this.manifest.tagName;if(this.classList.add(e),this.manifest.template){let t=this.manifest.template;(c(this,z)&E.propOnly)==E.propOnly&&(t=t.replace(/\{\{(.+?)\}\}/g,(...r)=>`<${c(this,le)}>${r[1]}</${c(this,le)}>`)),this.innerHTML=t,(c(this,z)&E.funOnly)==E.funOnly&&d(this,et,gr).call(this)}m(this,Se,!0)},ce=new WeakSet,at=function(e){return typeof e=="object"&&e!==null?(Object.keys(e).forEach(t=>{e[t]=d(this,ce,at).call(this,e[t])}),new Proxy(e,{set:(t,r,a)=>(t[r]=d(this,ce,at).call(this,a),d(this,Ke,mr).call(this),!0)})):e},he=new WeakMap,Ke=new WeakSet,mr=function(){c(this,he)||(m(this,he,!0),Qt(()=>{d(this,Pe,wt).call(this),m(this,he,!1)}))},Pe=new WeakSet,wt=function(){c(this,Je).forEach(t=>{d(this,Ye,pr).call(this,t)}),this.querySelectorAll(c(this,le)).forEach(t=>{const r=d(this,Le,yt).call(this,t.origin);String(r)!==t.innerHTML&&(t.innerHTML=r)})},Ye=new WeakSet,pr=function(e){const t=`s-${e}`;this.querySelectorAll(`[${t}]`).forEach(a=>{const n=a.getAttribute(t),l=d(this,Le,yt).call(this,n);l!==a[e]&&(a[e]=l)})},Le=new WeakSet,yt=function(e){try{return e.split(".").reduce((t,r)=>t[r],this.$data)}catch(t){console.error(t);return}},Qe=new WeakSet,fr=function(e,t){let r=this.$data,a=e.split(".");for(let n=0;n<a.length;n++){const l=a[n];n==a.length-1?r[l]=t:r=r[l]}},et=new WeakSet,gr=function(){this.querySelectorAll("*").forEach(t=>{t.$this||(t.$this=this,t.$set=(r,a)=>{d(this,Qe,fr).call(this,r,a)})})},U=new WeakMap,B=new WeakSet,ge=async function(){c(this,Se)&&(c(this,U)==="initing"||c(this,U)==="inited"||this.isReady()&&(m(this,U,"initing"),this.loading=!0,await this.onInit(),this.loading=!1,m(this,U,"inited"),this.afterInit()))};class er extends _{constructor(){super()}isReady(){return!!this.config}afterInit(){this.mapConfig=this.config,this.mapView=this;const i=this.mapConfig.widgetManager||"webgis-widget-manager",e=document.createElement(i);e.startup({mapView:this,map:this.map,config:this.mapConfig.widgets,mapConfig:this.mapConfig}),this.childNodes[0]?this.insertBefore(e,this.childNodes[0]):this.appendChild(e)}}const es="";var li=Object.defineProperty,ci=Object.getOwnPropertyDescriptor,hi=(s,i,e,t)=>{for(var r=t>1?void 0:t?ci(i,e):i,a=s.length-1,n;a>=0;a--)(n=s[a])&&(r=(t?n(i,e,r):n(r))||r);return t&&r&&li(i,e,r),r};o.MapView=class extends er{constructor(){super()}async onInit(){const i=G(this.config.map,"map");i.setTarget(this),this.map=i,this.getObject=G}},o.MapView=hi([j({tagName:"ol-map",className:"ol-map",hasConfig:!0})],o.MapView);const ts="";var ui=Object.defineProperty,di=Object.getOwnPropertyDescriptor,mi=(s,i,e,t)=>{for(var r=t>1?void 0:t?di(i,e):i,a=s.length-1,n;a>=0;a--)(n=s[a])&&(r=(t?n(i,e,r):n(r))||r);return t&&r&&ui(i,e,r),r};o.ZoomWidget=class extends _{constructor(){super()}async onInit(){let i=new Pr({target:this});this.map.addControl(i)}},o.ZoomWidget=mi([j({tagName:"ol-zoom-widget",className:"ol-zoom-widget"})],o.ZoomWidget);const rs="";var pi=Object.defineProperty,fi=Object.getOwnPropertyDescriptor,gi=(s,i,e,t)=>{for(var r=t>1?void 0:t?fi(i,e):i,a=s.length-1,n;a>=0;a--)(n=s[a])&&(r=(t?n(i,e,r):n(r))||r);return t&&r&&pi(i,e,r),r};o.LayerList=(tr=class extends _{constructor(){super();h(this,Z,[])}async onInit(){let e=new Lr({target:this,noScroll:!0,collapsed:!1,trash:!1,extent:!0,show_progress:!1,displayInLayerSwitcher:t=>t.get("listMode")!=="hide"});e.on("drawlist",t=>{const r=t.li,a=r.getElementsByClassName("ol-layerswitcher-buttons")[0],n=r.getElementsByClassName("layerswitcher-opacity")[0];let l=document.createElement("div");l.title="透明度",l.innerHTML="%";const u=t.layer;n.style.display=c(this,Z).includes(u.ol_uid)?"block":"none",l.onclick=()=>{n.style.display==="block"?(n.style.display="none",m(this,Z,c(this,Z).filter(w=>w!==u.ol_uid))):(n.style.display="block",c(this,Z).push(u.ol_uid))},a.appendChild(l)}),this.map.addControl(e)}},Z=new WeakMap,tr),o.LayerList=gi([j({tagName:"ol-layer-list",className:"ol-layer-list"})],o.LayerList);const is="";var vi=Object.defineProperty,wi=Object.getOwnPropertyDescriptor,yi=(s,i,e,t)=>{for(var r=t>1?void 0:t?wi(i,e):i,a=s.length-1,n;a>=0;a--)(n=s[a])&&(r=(t?n(i,e,r):n(r))||r);return t&&r&&vi(i,e,r),r};o.BasemapList=class extends _{constructor(){super()}async onInit(){let i=new bi({target:this});this.map.addControl(i)}},o.BasemapList=yi([j({tagName:"ol-basemap-list",className:"ol-basemap-list"})],o.BasemapList);class bi extends Or{constructor(i){i=i||{},i.switcherClass=((i.switcherClass||"")+" ol-layerswitcher-image").trim(),i.mouseover=i.mouseover!==!1,super(i)}drawList(i,e){i.style.height="auto",e.getArray().filter(r=>r.get("isBasemap")).forEach(r=>{if(this.displayInLayerSwitcher(r)){let a=document.createElement("img");a.src=r.get("thumbnail")||"images/thumbnail.png";let n=document.createElement("p");n.innerHTML=r.get("title")||r.get("name");let l=document.createElement("li");l.className="ol-imgcontainer"+(r.getVisible()?" ol-visible":""),l.appendChild(a),l.appendChild(n),l.onclick=()=>{this.switchLayerVisibility(r,e)},this._setLayerForLI(l,r),this.testLayerVisibility(r)||l.classList.add("ol-layer-hidden"),i.appendChild(l)}})}overflow(){}}const ss="",Mi="<div>{{coordinate}} 比例尺 {{scale}}</div>";var $i=Object.defineProperty,Si=Object.getOwnPropertyDescriptor,Ci=(s,i,e,t)=>{for(var r=t>1?void 0:t?Si(i,e):i,a=s.length-1,n;a>=0;a--)(n=s[a])&&(r=(t?n(i,e,r):n(r))||r);return t&&r&&$i(i,e,r),r};o.Coordinate=class extends _{constructor(){super()}async onInit(){this.$data={coordinate:"",scale:""};const i=this.map.getViewport();jr.listen(i,"pointermove",this.handleMouseMove,this),this.map.on("moveend",this.moveEnd.bind(this))}handleMouseMove(i){const e=this.map.getEventPixel(i),t=this.map.getCoordinateFromPixelInternal(e);t&&(this.$data.coordinate=`${t[0].toFixed(3)} ${t[1].toFixed(3)}`)}moveEnd(){const i=this.getScale();(i??!1)&&(this.$data.scale=`1:${i.toLocaleString()}`)}getScale(){const i=this.map.getView(),e=25.4/.28,t=1e3/25.4;var r=1;return i.getProjection().getUnits()!="metric"?r=i.getResolution()*i.getProjection().getMetersPerUnit()*t*e:r=i.getResolution()*t*e,Math.round(r)}},o.Coordinate=Ci([j({tagName:"ol-coordinate",className:"ol-coordinate",template:Mi})],o.Coordinate);const as="",Pi=`<div class="attribute">\r
    <table class="table">\r
\r
    </table>\r
    <div>\r
        <button class="btn" onclick="$this.delete()">删除</button>\r
        <button class="btn" onclick="$this.upload()">提交</button>\r
    </div>\r
</div>\r
<input class="shp-upload" multiple type="file" onchange="$this.readFile(event)" id="shp-upload" name="shp-upload"\r
    accept=".shp,.prj,.dbf,.shx">\r
<!-- <input class="shp-upload" type="file" onchange="$this.readFile(event)" id="shp-upload" name="shp-upload" accept=".zip"> -->`;var Li=Object.defineProperty,Oi=Object.getOwnPropertyDescriptor,ji=(s,i,e,t)=>{for(var r=t>1?void 0:t?Oi(i,e):i,a=s.length-1,n;a>=0;a--)(n=s[a])&&(r=(t?n(i,e,r):n(r))||r);return t&&r&&Li(i,e,r),r};o.EditBar=(rr=class extends _{constructor(){super();h(this,je);h(this,rt);h(this,J);h(this,Te);h(this,it);h(this,T,void 0);h(this,ue,void 0);h(this,W,void 0);h(this,V,void 0);ar(this,"notification");h(this,de,void 0);h(this,Oe,[]);h(this,tt,0);h(this,me,void 0)}async onInit(){const e=new Ct({source:new Pt,style:function(w){return new ot({image:new Lt({radius:5,stroke:new ct({width:1.5,color:w.get("color")||[255,128,0]}),fill:new Ot({color:(w.get("color")||[255,128,0]).concat([.3])})}),stroke:new ct({width:2.5,color:w.get("color")||[255,128,0]}),fill:new Ot({color:(w.get("color")||[255,128,0]).concat([.3])})})}});e.set("listMode","hide"),this.map.addLayer(e),m(this,ue,e);let t={edition:!0,select:!1,delete:!1,info:!1,drawPoint:!0,drawLine:!0,drawPolygon:!0,drawHole:!0,drawRegular:!0,transform:!0,split:!0,offset:!0};t=Object.assign(t,this.config.tools);const r=new Tr({source:e.getSource(),target:this,interactions:{Select:!1,Delete:!1,Info:!1,DrawPoint:t.drawPoint&&{title:"绘制点"},DrawLine:t.drawLine&&{title:"绘制线"},DrawPolygon:t.drawPolygon&&{title:"绘制面"},DrawHole:t.drawHole&&{title:"绘制岛面"},DrawRegular:t.drawRegular&&{title:"绘制多边形",ptsLabel:"边"},Transform:t.transform&&{title:"旋转/缩放"},Split:t.split&&{title:"打断"},Offset:t.offset&&{title:"偏移"},UndoDraw:"回退",FinishDraw:"完成"}}),a=new Dr({layers:[e]});a.on("change:active",()=>{a.getActive()||(a.getFeatures().clear(),d(this,J,_e).call(this))}),a.on("select",w=>{d(this,rt,vr).call(this,w)}),m(this,V,new Ar({features:a.getFeatures()})),this.map.addInteraction(c(this,V)),c(this,V).setActive(!1);const n=new Er({html:'<div class="attr-edit">☰</div>',title:"属性编辑",interaction:a});r.addControl(n);const l=this.map.interactions.getArray().find(w=>w instanceof xr);[r.getInteraction("DrawPoint"),r.getInteraction("DrawLine"),r.getInteraction("DrawPolygon"),r.getInteraction("DrawHole"),r.getInteraction("DrawRegular")].forEach(w=>{w==null||w.on("drawend",M=>{l.setActive(!1),d(this,je,bt).call(this,M.feature),setTimeout(()=>{l.setActive(!0)},0)})}),m(this,me,a);const f=new qr({html:'<div class="upload"><label>➜</label></div>',title:"上传shp",handleClick:()=>this.uploadShp()});r.addControl(f),this.map.addControl(r),this.notification=new St({}),this.map.addControl(this.notification)}uploadShp(){m(this,de,c(this,de)||this.getElementsByClassName("shp-upload")[0]),c(this,de).click()}async readFile(e){var a;const t=e.currentTarget,r=t.files;if(r.length!==0){this.loading=!0;try{let n,l;for(let y=0;y<r.length;y++){const[S,F]=r[y].name.split(".");if(F.toLowerCase()==="shp"){n=S,l=r[y];break}}if(!l)throw new Error("没有找到shp文件");const u=await this.loadFile(l);if(!u)throw new Error("读取文件失败");let f=await window.shp(u).then(y=>y,y=>{throw new Error(y)}),w;for(let y=0;y<r.length;y++){const[S,F]=r[y].name.split(".");if(F.toLowerCase()==="prj"&&S==n){w=r[y];break}}let M;if(w){let y=await this.loadFile(w,"text");y=y.replace("Gauss_Kruger","Transverse_Mercator");let S=c(this,Oe).find(Xi=>Xi.prj===y),F;S?F=S.name:(F=`ESRI:${nr(this,tt)._++}`,c(this,Oe).push({name:F,prj:y}),Tt.defs(F,y),Fr.register(Tt));const ki=this.map.getView().getProjection().getCode();M=new jt().readFeatures(f,{dataProjection:F,featureProjection:ki})}else M=new jt().readFeatures(f);const A=M[0];if(A){c(this,ue).getSource().addFeature(A);const y=(a=A.getGeometry())==null?void 0:a.getExtent();this.map.getView().fit(y,{padding:[50,50,50,50],duration:1e3}),d(this,je,bt).call(this,A)}else throw new Error("没有找到上传的图形")}catch(n){console.error(n),this.notification.show(n)}finally{t.value=null,this.loading=!1}}}loadFile(e,t){return new Promise((r,a)=>{const n=new FileReader;switch(t){case"text":n.readAsText(e);break;case"buffer":n.readAsArrayBuffer(e);break;case"binary":n.readAsBinaryString(e);break;default:n.readAsDataURL(e);break}n.onload=l=>{var f;let u=(f=l.target)==null?void 0:f.result;r(u)},n.onerror=l=>{n.abort(),a(l)}})}delete(){c(this,ue).getSource().removeFeature(c(this,W)),m(this,W,null),d(this,J,_e).call(this)}getDate(e){let t;if(e)typeof e=="string"?t=new Date(e):t=e;else return"";const r=t.getFullYear(),a=t.getMonth()+1,n=t.getDate();return`${this.pad(r,4)}-${this.pad(a)}-${this.pad(n)}`}pad(e,t=2,r="0"){return e.toString().padStart(t,r)}getTime(e){let t;if(e)typeof e=="string"?t=new Date(e):t=e;else return"";return t.toLocaleTimeString("zh-cn",{hour:"numeric",minute:"numeric",hour12:!1})}getDefaultValue(e,t){let r="";try{switch(t==null?void 0:t.toLowerCase()){case"$guid":r=`{${Nr.v4()}}`;break;case"$date":let a=new Date;r=`${this.getDate(a)} ${this.getTime(a)}`;break;case"$area":const n=e.getGeometry();n&&(r=_r.getArea(n,{projection:this.map.getView().getProjection()}).toFixed(3));break;default:r=t||"";break}}catch(a){console.error(a)}return r}upload(){if(!c(this,W)){this.notification.show("请先绘制一个图形");return}let e=new Ir().writeFeaturesObject([c(this,W)],{featureProjection:this.map.getView().getProjection()});e=this.beforeUpload(e);let t=`features=${JSON.stringify(e.features)}&rollbackOnFailure=true&f=pjson`;const r=this.config.layer.url+"/addFeatures";fetch(r,{method:"POST",body:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(a=>a.json()).then(a=>{if(a.error){const n=a.error.details[0]||a.error.message;this.notification.show(`提交失败 ${n}`),console.error(a.error),this.afterUpload(!1)}else this.notification.show("提交完成"),this.delete(),this.map.getAllLayers().forEach(n=>{var l;((l=n.get("type"))==null?void 0:l.toLowerCase())==="image"&&n.getSource().refresh()}),this.afterUpload(!0)}).catch(a=>{console.error(a),this.afterUpload(!1)})}beforeUpload(e){return e}afterUpload(e){}},T=new WeakMap,ue=new WeakMap,W=new WeakMap,V=new WeakMap,de=new WeakMap,Oe=new WeakMap,tt=new WeakMap,me=new WeakMap,je=new WeakSet,bt=function(e){c(this,me).setActive(!0),c(this,me).getFeatures().extend([e]),d(this,Te,Mt).call(this,e)},rt=new WeakSet,vr=function(e){const t=e.target.getFeatures(),r=t.getLength();if(r===0)d(this,J,_e).call(this);else if(r>1)d(this,J,_e).call(this);else{const a=t.getArray()[0];d(this,Te,Mt).call(this,a)}},J=new WeakSet,_e=function(){c(this,V).setActive(!1),m(this,T,c(this,T)||this.getElementsByClassName("attribute")[0]),c(this,T).style.display="none"},Te=new WeakSet,Mt=function(e){c(this,V).setActive(!0),m(this,W,e);let t=this.config.layer.fields||[],r=document.createElement("table");r.classList.add("table"),t.forEach(a=>{let n=document.createElement("tr"),l=document.createElement("td");l.innerHTML=a.alias||a.name;let u=document.createElement("td");u.appendChild(d(this,it,wr).call(this,e,a)),n.appendChild(l),n.appendChild(u),n.style.display=a.isDisplay===!1?"none":"table-row",r.appendChild(n)}),m(this,T,c(this,T)||this.getElementsByClassName("attribute")[0]),c(this,T).replaceChild(r,c(this,T).firstChild),c(this,T).style.display="block"},it=new WeakSet,wr=function(e,t){var a,n;let r=e.get(t.name)||this.getDefaultValue(e,t.defaultValue);if(e.set(t.name,r),((a=t.type)==null?void 0:a.toLowerCase())==="date"){let l=document.createElement("div"),u=document.createElement("input");u.type="date",u.value=this.getDate(r);let f=document.createElement("input");return f.type="time",f.value=this.getTime(r),f.oninput=u.oninput=()=>{e.set(t.name,`${u.value} ${f.value}`)},t.editable==!1&&(u.readOnly=!0,f.readOnly=!0),l.appendChild(u),l.appendChild(f),l.classList.add("date-time"),l}else{let l=document.createElement("input");t.editable==!1&&(l.readOnly=!0);let u;switch((n=t.type)==null?void 0:n.toLowerCase()){case"string":u="text";break;case"guid":u="text";break;case"int":u="number";break;case"double":u="number";break;default:u="text";break}return l.type=u,l.oninput=f=>{e.set(t.name,f.target.value)},l.value=r,l}},rr),o.EditBar=ji([j({tagName:"ol-edit-bar",className:"ol-edit-bar",template:Pi})],o.EditBar);const ns="",Ti=`<div s-title="title" class="btn" onclick="$this.btnClick(event)">\r
    <div class="arrow">&#8678</div>\r
</div>`;var Ei=Object.defineProperty,_i=Object.getOwnPropertyDescriptor,Ii=(s,i,e,t)=>{for(var r=t>1?void 0:t?_i(i,e):i,a=s.length-1,n;a>=0;a--)(n=s[a])&&(r=(t?n(i,e,r):n(r))||r);return t&&r&&Ei(i,e,r),r};o.Overview=class extends _{constructor(){super()}async onInit(){this.$data={title:"显示鹰眼图",display:!1},this.classList.add("overview-hide");const i=this.mapConfig.map.layers.filter(r=>r.isBasemap===!0),e=G(i,"map");let t=new Gr({target:this,layers:e,rotation:!0,panAnimation:!0,minZoom:0,maxZoom:20});this.map.addControl(t)}btnClick(){this.$data.display=!this.$data.display,this.$data.display?(this.$data.title="隐藏鹰眼图",this.classList.remove("overview-hide")):(this.$data.title="显示鹰眼图",this.classList.add("overview-hide"))}},o.Overview=Ii([j({tagName:"ol-overview",className:"ol-overview",template:Ti})],o.Overview);const os="",Di=`<div class="header">\r
    <label>卷帘开关</label>\r
    <input type="checkbox" class="switch" id="switch" onclick="$this.switchChange(event)">\r
    <label for="switch"></label>\r
</div>\r
<div class="left">\r
    <div class="title">左侧</div>\r
    <div class="layer-list-left">\r
    </div>\r
</div>\r
<div class="right">\r
    <div class="title">右侧</div>\r
    <div class="layer-list-right">\r
    </div>\r
</div>`;var Ai=Object.defineProperty,qi=Object.getOwnPropertyDescriptor,xi=(s,i,e,t)=>{for(var r=t>1?void 0:t?qi(i,e):i,a=s.length-1,n;a>=0;a--)(n=s[a])&&(r=(t?n(i,e,r):n(r))||r);return t&&r&&Ai(i,e,r),r};o.Swipe=(ir=class extends _{constructor(){super();h(this,k,void 0);h(this,X,void 0);h(this,x,void 0);h(this,pe,[])}async onInit(){m(this,x,new Br),this.drawList();let e=this.map.getLayerGroup().getLayers();e.on("change:length",()=>{this.drawList(),this.listen(e)}),this.listen(e)}removeListeners(){c(this,pe).forEach(e=>{Wr.unByKey(e)}),m(this,pe,[])}listen(e){this.removeListeners(),e.getArray().forEach(t=>{c(this,pe).push(t.on("change:visible",()=>{this.drawList()}))})}switchChange(e){e.target.checked?this.map.addControl(c(this,x)):this.map.removeControl(c(this,x))}drawList(){m(this,k,c(this,k)||this.getElementsByClassName("layer-list-left")[0]),m(this,X,c(this,X)||this.getElementsByClassName("layer-list-right")[0]);let e=[];this.getLayers(this.map.getLayers(),e),c(this,k).innerHTML="",c(this,k).appendChild(this.createUl(e,"left")),c(this,X).innerHTML="",c(this,X).appendChild(this.createUl(e,"right"))}getLayers(e,t){e.getArray().forEach(r=>{r.getLayers&&r.getVisible()?this.getLayers(r.getLayers(),t):r.getVisible()&&t.push(r)})}createUl(e,t){const r=document.createElement("ul");return e.forEach(a=>{let n=a.ol_uid,l=a.get("title");const u=a.get("isBasemap");if(n&&l){n=`${t}_${n}`,l=u?`${l}（底图）`:l;const f=document.createElement("li");f.innerHTML=`<div class="checkbox"><input type="checkbox" id="${n}">
                <label for="${n}" title="${l}"><span>${l}</span></label></div>`;const w=f.getElementsByTagName("input")[0];w.onclick=M=>{let A=M.target.checked;this.onLayerClick({layer:a,type:t,checked:A})},w.checked=this.getCheckBoxState(a,t),r.appendChild(f)}}),r}getCheckBoxState(e,t){const r=c(this,x).layers;for(var a=0;a<r.length;a++)if(r[a].layer===e&&r[a].right===(t==="right"))return!0;return!1}onLayerClick(e){if(c(this,x).removeLayer(e.layer),e.checked){const r=`${e.type==="right"?"left":"right"}_${e.layer.ol_uid}`,a=document.getElementById(r);a.checked=!1,c(this,x).addLayer(e.layer,e.type==="right")}}},k=new WeakMap,X=new WeakMap,x=new WeakMap,pe=new WeakMap,ir),o.Swipe=xi([j({tagName:"ol-swipe",className:"ol-swipe-widget",template:Di})],o.Swipe);class Fi extends Hr{constructor(e){e=e||{};super(e);h(this,K,0);h(this,fe,0)}animate(e){const t=this.easing_(e.elapsed);if(t){let r=e.style,a,n;for(a=0;a<r.length;a++)n=r[a].getImage(),n&&n.getRadius&&(m(this,fe,c(this,fe)||n.getRadius()),n.setRadius(c(this,fe)*t),n.setOpacity(1-t),m(this,K,c(this,K)||n.getStroke().getWidth()),n.getStroke().setWidth(c(this,K)-c(this,K)*t));this.drawGeom_(e,e.geom)}return e.time<=this.duration_}}K=new WeakMap,fe=new WeakMap;const ls="",Ni=`<div class="row">\r
    <div class="label">坐标系:</div>\r
    <div class="div">\r
        <select s-value="prj" name="prj" onchange="$this.$data.prj=value">\r
            <option value="4326">地理坐标（经纬度）</option>\r
            <option value="3857">投影坐标（平面坐标）</option>\r
        </select>\r
    </div>\r
</div>\r
<div class="row">\r
    <div class="label">X:</div>\r
    <div class="div">\r
        <input type="number" s-value="x" oninput="$this.$data.x=value">\r
    </div>\r
\r
</div>\r
<div class="row">\r
    <div class="label">Y:</div>\r
    <div class="div">\r
        <input type="number" s-value="y" oninput="$this.$data.y=value">\r
    </div>\r
</div>\r
<div class="row btn">\r
    <button onclick="$this.submit()">定位</button>\r
</div>`;var Gi=Object.defineProperty,Bi=Object.getOwnPropertyDescriptor,Wi=(s,i,e,t)=>{for(var r=t>1?void 0:t?Bi(i,e):i,a=s.length-1,n;a>=0;a--)(n=s[a])&&(r=(t?n(i,e,r):n(r))||r);return t&&r&&Gi(i,e,r),r};o.Location=(sr=class extends _{constructor(){super();h(this,Ee,void 0)}async onInit(){this.$data={x:null,y:null,prj:"4326"},this.notification=new St({}),this.map.addControl(this.notification),m(this,Ee,new Ct({source:new Pt})),c(this,Ee).setMap(this.map)}submit(){if(this.$data.x&&this.$data.y){const e=C.transform([this.$data.x,this.$data.y],`EPSG:${this.$data.prj}`,this.map.getView().getProjection()),t=this.map.getView().getProjection().getExtent();lt.containsCoordinate(t,e)?(this.map.getView().animate({center:e,duration:100}),this.pulse(e)):this.notification.show("坐标超出地图范围！")}else this.notification.show("请输入坐标！")}pulse(e){for(let t=0;t<4;t++)setTimeout(()=>{this.pulseFeature(e)},t*500)}pulseFeature(e,t=3e3){let r=new Vr(new Rr(e));r.setStyle(new ot({image:new Lt({radius:24,stroke:new ct({color:"rgb(255,0,0)",width:3})})})),this.map.animateFeature(r,new Fi({fade:Et.easeOut,duration:t,easing:Et.easeOut}))}},Ee=new WeakMap,sr),o.Location=Wi([j({tagName:"ol-location",className:"ol-location",template:Ni})],o.Location);const cs="",Vi=`<fieldset>\r
    <legend>\r
        数据解析\r
    </legend>\r
    <div>\r
        <button onclick="$this.add(event)">测试加一</button>\r
        结果：{{a}}\r
    </div>\r
\r
    <div>\r
        <button onclick="$this.changeName(event)">测试人名</button>\r
        你是：{{b}}\r
    </div>\r
\r
\r
    <div>\r
        <button onclick="$this.changeValue(event)">测试多重属性</button>\r
        c.d.e : {{c.d.e}}\r
    </div>\r
\r
\r
    <div>\r
        <button onclick="$this.changeArr(event)">测试数组</button>\r
        数组长度：{{f.length}}\r
    </div>\r
</fieldset>\r
\r
\r
<fieldset>\r
    <legend>\r
        事件数据绑定\r
    </legend>\r
    <div>\r
        <input oninput="$this.$data.aa=value">\r
        <br>\r
        结果：{{aa}}\r
    </div>\r
</fieldset>\r
\r
<fieldset>\r
    <legend>\r
        属性绑定 + 直接赋值\r
    </legend>\r
    <div>\r
        <input s-value="bb" oninput="$this.$data.bb=value">\r
        <br>\r
        结果：{{bb}}\r
    </div>\r
</fieldset>\r
\r
<fieldset>\r
    <legend>\r
        属性绑定 + 绑定赋值\r
    </legend>\r
    <div>\r
        <input s-value="cc" oninput="$set('cc',value)">\r
        <!-- <input s-value="cc" oninput="console.log(this)"> -->\r
        <br>\r
        结果：{{cc}}\r
    </div>\r
</fieldset>`;var Ri=Object.defineProperty,Hi=Object.getOwnPropertyDescriptor,zi=(s,i,e,t)=>{for(var r=t>1?void 0:t?Hi(i,e):i,a=s.length-1,n;a>=0;a--)(n=s[a])&&(r=(t?n(i,e,r):n(r))||r);return t&&r&&Ri(i,e,r),r};o.HelloWorld=class extends _{constructor(){super()}async onInit(){this.$data={a:1,b:"张三",c:{d:{e:1}},f:[1],aa:"123",bb:"start",cc:"121"}}hello(i){console.log(i),this.$data.c.d="和了了了了了了"}changeName(){this.$data.b=this.$data.b=="张三"?"李四":"张三"}changeValue(){this.$data.c.d={e:this.$data.c.d.e+1}}changeArr(){this.$data.f.push(1)}add(){this.$data.a++}kill(){return"hello"}},o.HelloWorld=zi([j({tagName:"ol-hello-world",className:"ol-hello-world",template:Vi})],o.HelloWorld);const hs="";var Ui=Object.defineProperty,Zi=Object.getOwnPropertyDescriptor,Ji=(s,i,e,t)=>{for(var r=t>1?void 0:t?Zi(i,e):i,a=s.length-1,n;a>=0;a--)(n=s[a])&&(r=(t?n(i,e,r):n(r))||r);return t&&r&&Ui(i,e,r),r};o.MapViewTest=class extends er{constructor(){super()}async onInit(){const i=G(this.config.map,"map");i.setTarget(this),i.addControl(new zr.MousePosition),this.map=i}},o.MapViewTest=Ji([j({tagName:"ol-map-test",className:"ol-map-test",hasConfig:!0})],o.MapViewTest),o.Objects=Kt,o.StyleFn=_t,o.TextFn=It,o.getConstructor=Yt,o.getObject=G,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
